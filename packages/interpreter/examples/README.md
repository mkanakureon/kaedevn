# examples/ — .ksc Sample Scripts

> Generated by Claude Opus 4.6

インタプリタの動作確認用 `.ksc` (Kaede Script) サンプルスクリプト集。
コンソールデモ（`npm run demo`）や統合テストで使用される。

## 実行方法

```bash
# 01-hello.ksc をコンソールで実行
npm run demo
```

## ファイル一覧

### 01-hello.ksc — 基本コマンドデモ

最もシンプルなサンプル。インタプリタの基本機能を一通り体験できる。

**使用機能:**
- `bg()` — 背景設定（通常・エフェクト付き）
- `ch()` / `ch_hide()` — キャラクター表示・非表示
- `bgm()` — BGM 再生
- `wait()` — 待機
- `#キャラ名 ... #` — セリフブロック

**ストーリー:** 学校の朝、主人公とヒロインが挨拶を交わし、それぞれの教室へ向かう短いシーン。

### 02-labels.ksc — ラベルとジャンプ

ラベル、ジャンプ、サブルーチン（call/ret）の動作確認用。

**使用機能:**
- `*label` — ラベル定義
- `jump("label")` — ラベルへのジャンプ
- `call("label")` / `ret()` — サブルーチン呼び出しとリターン

**ストーリー:** 転校初日の朝。朝のルーティン（サブルーチン）を挟みながら、
学校に到着してヒロインと出会うまでの流れ。

### 03-variables.ksc — 変数と式評価

変数、式評価、代入演算の動作確認用。

**使用機能:**
- 変数宣言・代入（`=`）
- 複合代入演算（`+=`, `-=`, `*=`）
- 算術演算（`+`, `-`, `*`, `/`）
- 比較演算（`>=`）
- 文字列結合
- 複雑な式の評価（括弧付き、優先順位）

**ストーリー:** ゲームの各ステージをテーマに、算術演算 → 複雑な式 → 文字列操作 → 複合代入 → 最終スコア計算の順に変数操作を実演する。

### 05-conditionals.ksc — 条件分岐

if / else if / else による条件分岐の動作確認用。

**使用機能:**
- `if (条件) { }` — 基本の条件分岐
- `if / else` — 二択分岐
- `if / else if / else` — 多段分岐
- ネストした条件分岐
- 論理演算子（`&&`, `||`, `!`）
- 文字列補間 `{変数名}`

**ストーリー:** テストの成績発表。点数からランク判定、追加課題ボーナスの適用、参加許可の条件チェックを行う。

### 06-choices.ksc — 選択肢

choice ブロックによる選択肢の動作確認用。

**使用機能:**
- `choice { }` — 基本の選択肢
- `"テキスト" if (条件) { }` — 条件付き選択肢
- 選択肢内での変数操作
- 選択肢内での `jump()` によるルート分岐

**ストーリー:** 放課後の友人との行動。選択によって信頼度が変化し、親友 / 友人 / 知人ルートに分岐する。

### 07-functions.ksc — 関数・サブルーチン

def（関数）と sub（サブルーチン）の動作確認用。

**使用機能:**
- `def 関数名(引数) { return 値 }` — 戻り値のある関数
- `sub 名前(引数) { }` — 副作用のあるサブルーチン
- 引数の受け渡し
- 関数のネスト呼び出し
- 関数内での条件分岐
- 文字列補間内での関数呼び出し `{関数名()}`
- サブルーチンからサブルーチンの呼び出し

**ストーリー:** RPG 風のクエストシステム。スコア計算、ランク判定、ポイント加算、報酬獲得をサブルーチンで管理する。

### 08-commands.ksc — 組み込みコマンド一覧

全 17 の組み込みコマンドを網羅したリファレンス用サンプル。

**使用機能:**
- `bg(name)` / `bg(name, effect)` — 背景設定
- `ch(name, pose)` / `ch(name, pose, pos)` / `ch(name, pose, pos, fade)` — キャラクター表示
- `ch_anim(name, pose, pos)` — キャラクターアニメーション
- `ch_hide(name)` / `ch_hide(name, fade)` — キャラクター非表示
- `ch_clear()` / `ch_clear(fade)` — 全キャラクタークリア
- `bgm(name)` / `bgm(name, vol)` / `bgm(name, vol, fade)` — BGM 再生
- `bgm_stop()` / `bgm_stop(fade)` — BGM 停止
- `se(name)` / `se(name, vol)` — 効果音
- `voice(name)` — ボイス再生
- `wait(ms)` — 時間待機
- `waitclick()` — クリック待ち
- `jump(label)` / `call(label)` / `ret()` — フロー制御
- `timeline(name)` / `timeline_play(name)` — タイムライン
- `battle(troopId)` — バトル

### 04-full-scenario.ksc — 完全なゲームシナリオ

全機能を使った学園恋愛ノベルの完全なシナリオ。

**使用機能:**
- 変数初期化・演算（`affection`, `flag_library`, `flag_rooftop` 等）
- `def` による関数定義（`mood()`, `affection_message()`）
- `sub` によるサブルーチン定義（`show_affection()`, `morning_greeting()`）
- `choice { }` — 4 つの選択肢（条件付き選択肢を含む）
- `if` — 好感度による複合条件分岐（`&&`, `||`）
- `jump()` / `call()` — ラベルジャンプ・サブルーチン呼び出し
- 文字列補間 `{変数名}` / `{関数呼び出し()}`

**ストーリー:** 好感度システム付きの学園恋愛。選択肢で好感度を上下させ、
トゥルーエンド / ノーマルエンド / バッドエンド / 友達エンドの 4 つのエンディングに分岐する。
